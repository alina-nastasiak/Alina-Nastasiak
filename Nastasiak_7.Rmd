---
title: "Lab7_Nastasiak"
output:
  html_document:
    df_print: paged
---


ЧАСТИНА 1. Функція prepare_set

```{r}
prepare_set<-function(file_name){
  setwd("/Users/alinanastasyak/Desktop/пари 5 2/R")
  df<-read.csv(file_name, skip = 1, header = TRUE, encoding="UTF-8", stringsAsFactors = FALSE)
  colnames(df)[1]="Country"
  for (i in (1:length(colnames(df)))){
  if (str_detect(colnames(df)[i], "X01")){
    colnames(df)[i]=str_replace(colnames(df)[i],"X01..","Gold")
  }
  if (str_detect(colnames(df)[i], "X02")){
    colnames(df)[i]=str_replace(colnames(df)[i],"X02..","Silver")
  }
  if (str_detect(colnames(df)[i], "X03")){
    colnames(df)[i]=str_replace(colnames(df)[i],"X03..","Bronze")
  }
  if (str_detect(colnames(df)[i], "X..")){
    colnames(df)[i]=str_replace(colnames(df)[i],"X..","")
  }
  
  }
country=c()
ID=c()
for (i in (1:length(df["Country"][[1]]))){
  country[i]=str_split(df['Country'][[1]][i],"\\s+\\(.*",simplify = TRUE)[1,1]
  ID[i]=str_split(df['Country'][[1]][i],"\\(",n=2,simplify = TRUE)[1,2]
  ID[i]=substring(id[i],1,3)
  
}
df["Country"]=country
df2=add_column(df, ID, .before = 1)
df2=head(df2,-1)
  return (df2)
  }

olympics <- prepare_set("olympics.csv")
olympics
```

Котра країна виграла найбільшу кількість золотих нагород на літніх іграх?

```{r}
answer_one<-function(){
  country_max=''
  gold_max=0
  for (i in (1:length(olympics['Country'][[1]]))){
    if (olympics['Gold'][[1]][i]>gold_max) {country_max=olympics['Country'][[1]][i]}
  }
  return(country_max)
}
answer_one()
```

Яка країна має найбільшу різницю між кількістю нагород на літніх та зимових іграх?
```{r}
answer_two<-function(){
  country_dif=''
  dif=0
  for (i in (1:length(olympics['Country'][[1]]))){
    if ((olympics['Summer'][[1]][i]-olympics['Winter'][[1]][i])>dif)   {
      country_dif=olympics['Country'][[1]][i]
      }
  }
  return(country_dif)
}
answer_two()
```
В якій крайні найбільша різниця між літніми та зимовими золотими нагородами відносно до загальної кількості нагород (Summer Gold - Winter Gold) / Total Gold. Врахувати тільки країни які мають як мінімум по одній нагороді в літніх та зимових іграх.
```{r}
answer_three<-function(){
  country_dif2=''
  dif=0
  for (i in (1:length(olympics['Country'][[1]]))){
    if ((olympics['Summer'][[1]][i]>=1) & (olympics['Winter'][[1]][i]>=1)){
    
      if (((olympics['Summer'][[1]][i]-olympics['Winter'][[1]][i])/olympics['Total'][[1]][i])>dif)   {
        country_dif2=olympics['Country'][[1]][i]
      }
    }
  }
  return(country_dif2)
}
answer_three()
```

Необхідно знайти кількість балів по кожній крайні. Бали рахуються наступним чином: Золота нагорода Gold.2 це три бали, срібна Silver.2 - 2 бали та бронзова Bronze.2 – 1 бал.
```{r}
answer_four<-function(){
 country_new=olympics['Country'][[1]]
 Points=c()
 for (i in (1:length(olympics['Country'][[1]]))){
   Points[i]=olympics['Gold.2'][[1]][i]*3+olympics['Silver.2'][[1]][i]*2+olympics['Bronze.2'][[1]][i]*1
 }
 new_olimp<-data.frame(country_new,Points)
 colnames(new_olimp)[1]='Country'
 return(new_olimp)
}
answer_four()

```

ЧАСТИНА 2
```{r}
census_df <- read.csv("census.csv", stringsAsFactors = FALSE)
census_df
```

В якому штаті (state) більше всього округів (county)?
```{r}
answer_five<-function(){

big_state=''
state=unique(unlist(census_df['STATE']))
state_name=unique(unlist(census_df['STNAME']))
max_county=0
for (i in state){
  if (max_county<sum(census_df['COUNTY'][census_df['STATE']==i])){
    max_county=sum(census_df['COUNTY'][census_df['STATE']==i])
    big_state=state_name[i]
  }
  
}
return(big_state)
}
answer_five()
```

Якщо розглядати три найбільш населених округа (county) з кожного штату, які три найбільш населені штати (в порядку з більш до менш населеного)?

```{r}
answer_six<-function(){
  var6=c()
  j=1
df_sort<-arrange(census_df,CENSUS2010POP)
df_6=tail(df_sort['STNAME'],3)
for (i in (length(df_6[[1]]):1)){
  var6[j]=df_6[[1]][i]
  j=j+1
}
return(var6)
}
answer_six()
```
Який округ (county) має найбільшу абсолютну зміну в населенні протягом періоду 2010-2015?

```{r}
answer_seven<-function(){
var=c()
var_max=-1
for (i in (1:length(census_df['COUNTY'][[1]]))){
  var=c()
  k=1
  for (m in (10:14)){
    f=m+1
    for (n in (f:15)){
      var[k]=(census_df[[n]][i]-census_df[[m]][i])
      k=k+1
    }
  }
  if (var_max<max(var)){
    county=census_df['COUNTY'][[1]][i]
    county_name=census_df['CTYNAME'][[1]][i]
    var_max=max(var)
    var=c()
    }
}

return(county_name)
#return(county)

}
answer_seven()
```

В census_df США поділені на 4 регіони (колонка "REGION"). Напишіть функцію, яка знаходить округи (county), що належать регіонам 1 або 2, назва яких починається з "Washington" та POPESTIMATE2015 більше ніж POPESTIMATE2014.

```{r}
answer_eight<-function(){
county_name=c()
st_name=c()
k=1
for (i in (1:length(census_df['REGION'][[1]]))){
  if (census_df['REGION'][[1]][i]==1 || census_df['REGION'][[1]][i]==2){
    if  (str_detect(census_df['CTYNAME'][[1]][i], "Washington")){
      if(census_df['POPESTIMATE2015'][[1]][i]>census_df['POPESTIMATE2014'][[1]][i]){ 
        county_name[k]=census_df['CTYNAME'][[1]][i]
        st_name[k]=census_df['STNAME'][[1]][i]
        k=k+1
        }
    }
  }
}
df_7<-data.frame(st_name,county_name)
colnames(df_7)[1]='STNAME'
colnames(df_7)[2]='CTYNAME'
return(df_7)
}

answer_eight()
```





